<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <link rel="stylesheet" href="./css/styles.css">
    <title>AI In a Nutshell</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Custom fonts for this template -->
    <link
      href="vendor/fontawesome-free/css/all.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"
      rel="stylesheet"
      type="text/css"
    />

    <!-- Custom styles for this template -->
    <link href="css/clean-blog.min.css" rel="stylesheet" />
  </head>

  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
      <div class="container">
        <div> <a style="display: flex; justify-content: space-around; margin-top: -1rem;" class="navbar-brand"
            href="index.html">
            <p>ai in a nutshell</p>
            <div><img style="margin-top: 1rem" src="img/logofinal2.png" height="50" width="80"></div>
        </div></a>
        <button
          class="navbar-toggler navbar-toggler-right"
          type="button"
          data-toggle="collapse"
          data-target="#navbarResponsive"
          aria-controls="navbarResponsive"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          Menu
          <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="about.html">About</a>
            </li>
            <li class="nav-item">
              <div class="dropdown">
                <button
                  class="btn btn btn-outline-light dropdown-toggle"
                  type="button"
                  id="dropdownMenu2"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                >
                  All Blogs
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
                <a href="decision_tree.html"><button class="dropdown-item" type="button">Decision Tree</button></a>
                <a href="random_forest.html"><button class="dropdown-item" type="button">Random Forest</button></a>
                <button class="dropdown-item" type="button">Gradient Boosting</button>
                  </button>
                </div>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Page Header -->
    <header class="masthead" style="background-image: url('img/rf_cover.jpeg')">
      <div class="overlay"></div>
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-md-10 mx-auto">
            <div
              style="padding-left: 7rem"
              class="post-heading align-content-center"
            >
              <h1>Random Forest</h1>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Post Content -->
    <article>
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-md-10 mx-auto">
            <p>
              Random Forest is a powerful and one of the most used supervised
              machine learning algorithm that works on bagging approach. It can
              be used both for classification and regression problems.
            </p>

            <p>
              The basic idea on which it works is combining multiple learning
              models and hence improving the overall result, this accounts for
              the word ‘forest’ in it’s name which means the combination of
              different decision trees. Generally, this algorithm produces a
              great as well as stable result by coping the disadvantages of a
              single decision tree which justify the word ‘random’ in its name.
            </p>

            <p>
              In this article we will understand the algorithm working behind
              along with it’s implementation in python
            </p>
            <h6>The problem with decision trees: :</h6>
            <p>
              Decision trees study the given data completely to it’s depth. This
              results in the loss of it’s generalization capabilities and
              compromise in it’s ‘flexibility’ and therefore, they tend to
              overfit the data. This is one of the main problem of decision
              trees as it fits the training data so well that ultimately it
              starts to give wrong predictions on test data.
            </p>
            <h4>Understanding the algorithm working behind :</h4>
            <p>
              The working of this amazing algorithm is quite simple. Since
              random forest works on bootstrap aggregation as discussed above,
              so firstly the data set is divided into different bits of sample
              rows and columns and each of the bit of data is trained on a
              different learning model, i.e. Decision Tree. A noticeable thing
              here is, the row and column sampling may serve some data to more
              than one decision tree, there is no thumb rule of making every bit
              of data separate for each model, it is chosen randomly to bring
              stability and generalization to out predictions.
            </p>
            <p>
              Unlike finding the best column to split, the columns are selected
              randomly in the case of Random forest to maintain a generalized
              arrangement of data.
            </p>
            <h5>Here is a diagrammatic representation of a Random Forest:</h5>
            <center><img src="img/randomforest.png" alt="" /></center>

            <p>
              Note: In the case of Regression, the result is taken by either
              avg. or median of all the predictions from the independent
              decision tree models while in Classification, the predicted class
              with the most frequency is taken.
            </p>

            <h5>Explanation with an Example:</h5>
            <p>
              Now let us use the concepts learnt above to build a Random forest
              step by step by taking an example data for a better understanding.
            </p>

            <h5>The diabetes data:</h5>
            <p>
              Following is the data to determine weather a patient is diabetic
              or not from 4 features.<br />
              • Pregnancies: Number of times pregnant<br />
              • Glucose: Plasma glucose concentration over 2 hours in an oral
              glucose tolerance test<br />
              • BMI: Body mass index (weight in kg/(height in m)2)<br />
              • Age: Age (years)<br />
            </p>
            <p>
              <i
                >*We are taking 4 features and 5 rows for understanding sake.</i
              >
            </p>
            <img src="img/rf1.png" alt="" />
            <h6>Step 1:</h6>
            <p>
              A random sampling of rows and columns is performed on the dataset,
              to select int input for the root of a decision tree. Let’s take
              the following part:
            </p>
            <img style="padding-left: 6rem" src="img/rf2.png" alt="" />
            <h6>Step 2:</h6>
            <p>
              Build a decision tree from the selected features. Say for example,
              BMI is taken as the root node for the first decision tree.
            </p>
            <img style="padding-left: 6rem" src="img/rf3.png" alt="" />
            <h6>Step 3:</h6>
            <p>
              Choose the no. of trees to be built and go back to Step 1. <br />
              There are a lot of decision trees built , but for explanation let
              us take 4 trees.<br />
              So, we can represent the process till now as follows : <br />
            </p>
            <img style="padding-left: 5rem" src="img/rf4.png" alt="" />
            <h6>Step 4:</h6>
            <p>
              Do a vote from all the trees’ prediction to calculate the final
              prediction.
            </p>
            <img style="padding-left: 10rem" src="img/rf5.png" alt="" />
            <p>
              From the above table , we can figure out that the Majority vote
              goes to the prediction ‘1’.
            </p>
          </div>
        </div>
        <div>
          <h3>Code Implementation</h3>
          <pre>
    <code>

   

    <div  class=" jumbotron">
    # Imprting the necessary libraries
    import pandas as pd
    import numpy as np
    import seaborn as sns
    <hr style= "height:2px;color:gray;background-color:gray">
    #loading the Iris dataset using seaborn
    df = sns.load_dataset('iris')
    <hr style= "height:2px;color:gray;background-color:gray">
    #mapping the target/label values
    df['species']=df['species'].map({'setosa':0,'versicolor':1,'virginica':2})
    <hr style= "height:2px;color:gray;background-color:gray">
    #seperating the feature and label dataframes
    X=df.drop(['species'],axis=1)
    y=df['species']
    <hr style= "height:2px;color:gray;background-color:gray">
    from sklearn.model_selection import train_test_split
    <hr style= "height:2px;color:gray;background-color:gray">
    X_train,X_test,y_train,y_test=train_test_split(X,y, test_size=0.2,random_state=0)
    <hr style= "height:2px;color:gray;background-color:gray">
    #importing Decision Tree
    from sklearn.ensamble import RandomforestClassifier
    <hr style= "height:2px;color:gray;background-color:gray">
    clf = RandomforestClassifier()
    <hr style= "height:2px;color:gray;background-color:gray">
    #fitting the classifier
    clf.fit(X_train,y_train)
    <hr style= "height:2px;color:gray;background-color:gray">
    #storing the predictions in y_pred
    y_pred = clf.predict(X_test)
    <hr style= "height:2px;color:gray;background-color:gray">
    #importing metrices
    from sklearn.metrics import  classification_report, accuracy_score, confusion_matrix
    <hr style= "height:2px;color:gray;background-color:gray">
    accuracy_score(y_test,y_pred)
    <hr style= "height:2px;color:gray;background-color:gray">
    print(confusion_matrix(y_test,y_pred))
    <hr style= "height:2px;color:gray;background-color:gray">
    print(classification_report(y_test,y_pred))
    <hr style= "height:2px;color:gray;background-color:gray">
    from sklearn.model_selection import GridSearchCV
    <hr style= "height:2px;color:gray;background-color:gray">
    param_grid = {
    'n_estimators': [40,50,100, 200, 300, 500],
    'learning_rate' : [0.0001, 0.001, 0.01, 0.1, 1.0],
    }
    <hr style= "height:2px;color:gray;background-color:gray">
    xgclf = XGBClassifier()
    grid_search = GridSearchCV(estimator = xgclf, param_grid = param_grid, 
                              cv = 3, n_jobs = -1, verbose = 2)
    <hr style= "height:2px;color:gray;background-color:gray">
    grid_search.fit(X_train,y_train)
    <hr style= "height:2px;color:gray;background-color:gray">
    #est parameters 
    grid_search.best_params_
    <hr style= "height:2px;color:gray;background-color:gray">
    </div>
    

    

    


    </code>
    </pre>
        </div>
      </div>
    </article>

    <hr />

    <!-- Footer -->
    <footer>
      <div class="container" >
        <div class="row">
          <div class="col-lg-8 col-md-10 mx-auto">
            <ul class="list-inline text-center " >
              <div class="wrapper" style="padding-left: 17.5rem;">
                <div class="button">
                  <div class="icon"><i class="fab fa-facebook-f"></i></div>
                  <span>Facebook</span>
                </div>
                
                <div class="button">
                  <div class="icon"><a href="https://www.linkedin.com/in/shivesh-narain-478003168/"><i
                        class="fab fa-instagram"></i></a></div>
                  <span>Instagram</span>
                </div>
                <div class="button">
                  <div class="icon"><i class="fab fa-github"></i></div>
                  <span>Github</span>
                </div>
                <div class="button">
                  <div class="icon"><i class="fab fa-youtube"></i></div>
                  <span>youtube</span>
                </div>
                <div>
            </ul>
            <center><p>Made with <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-heart" viewBox="0 0 16 16">
  <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"/>
</svg> in India </p></center>
          </div>
        </div>
      </div>
    </footer>

    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Custom scripts for this template -->
    <script src="js/clean-blog.min.js"></script>
  </body>
</html>
